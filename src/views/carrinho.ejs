<head>
    <script src="/javascripts/carrinho.js" defer></script>
    <link rel="stylesheet" href="/stylesheets/compra.css" />
</head>

<%- include('partials/header') %>
    <!--CONTEÚDO MAIN -->
    <main>
        <div>
            <div id="titulo">
                <h1>Finalizar Pedido</h1>
            </div>
            <section id="section-carrinho">
                <div class="content-carrinho">
                    <div id="titulo">
                        <h3>Itens: </h3>
                    </div>
                    <div id="itens-carrinho">
                        <% if(!itens[0]) { %>
                            <h3>SEU CARRINHO ESTA VAZIO</h3>
                        <% } %>
                        <% for(const filme of itens) { %>
                            <section class="item">
                                <input type="hidden" value="<%=filme.id%>" id="id" name="id">
                                <img class="imagem-produto" src="/img/<%= filme.tipo %>s/<%=filme.background%>.jpg" />
                                <div class="descricao-produto">
                                    <div>
                                        <h2 class="filme-nome">
                                            <%=filme.nome%>
                                        </h2>
                                        <br>
                                        <p class="filme-valor">
                                            R$ <%=filme.valor%>
                                        </p>
                                    </div>
                                    <div>
                                        <form action="/carrinho" method="GET" id="deletaItem">
                                            <input type="hidden" name="itensCarrinho" id="deletaItem"/>
                                            <button type="submit">
                                                <img class="remover" src="/img/ico/lixo.png" />
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </section>
                            <% } %>
                    </div>
                </div>
                <section class="pagamento">
                    <section class="resumo">
                        <div>
                            <h3>Detalhes de pagamento</h3>
                        </div>
                        <br>
                        <hr>
                        <div>
                            <h3>CARRINHO: <%= qtd %> itens</h3>
                            <span>
                                R$ <%= valor%>
                            </span>
                        </div>
                        <hr>
                        <div id="div-cupom">
                            <h3>CUPOM DE DESCONTO</h3>
                            <form action="/carrinho" method="GET" id="montarCarrinho">
                                <input type="hidden" name="itensCarrinho" id="itensCarrinho" />
                                <input name="cupom" type="text" placeholder="CUPOM" maxlength="12" value="<%= dadosCupom.cupom %>">
                                <button type="submit" id="bt-valida">Validar</button>
                                <h5 id="span-desconto"
                                    <% if(desconto == 0) { %>
                                        style="display: none;"
                                    <% } else { %>
                                        style="display: block;"
                                    <% } %>
                                >O desconto de R$ <%= desconto %> foi aplicado!</h5>
                            </form>
                        </div>
                        <hr>
                        <div>
                            <h2>TOTAL</h2>
                            <span>
                                R$ <%= total%>
                            </span>
                        </div>
                        <br>
                    </section>
                </section>
            </section>
            <section id="section-dados">
                <div class="content-form">
                    <div>
                        <h1>Dados: </h1>
                    </div>
                    <form id="form-dados" action="" disabled="disabled">
                        <div id="input-linha">
                            <div>
                                <div class="invisible err-nome error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="NOME*" name="nome" minlength="3" maxlength="20">
                            </div>
                            <div>
                                <div class="invisible err-sobrenome error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="SOBRENOME*" name="sobrenome" minlength="3" maxlength="20">
                            </div>
                            <div>
                                <div class="invisible err-cpf error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="CPF/CNPJ*" name="cpf" 
                                pattern="\d{3}\.\d{3}\.\d{3}-\d{2}">
                            </div>
                        </div>
                        <div id="input-linha"> 
                            <div>
                                <div class="invisible err-email error">Campo obrigatório!</div>
                                <input class="content-input" type="email" placeholder="EMAIL*" name="email">
                            </div>
                        </div>
                        <div id="input-linha">
                            <div>
                                <div class="invisible err-codigo-postal error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="CEP:*"
                                    name="codigo-postal" maxlength="8">
                            </div>
                            <div>
                                <div class="invisible err-endereco error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="ENDEREÇO*" name="endereco">
                            </div>
                        </div>
                        <div id="input-linha">
                            <div>
                                <div class="invisible err-cidade error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="BAIRRO*" name="bairro">
                            </div>
                            <div>
                                <div class="invisible err-cidade error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="CIDADE*" name="cidade">
                            </div>
                            <div>
                                <div class="invisible err-estado error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="ESTADO*" name="estado">
                            </div>
                            <div>
                                <div class="invisible err-pais error">Campo obrigatório!</div>
                                <input class="content-input" type="text" placeholder="PAÍS*" name="pais">
                            </div>
                        </div>
                        <div class="pay-button">
                            <button type="submit">Atualizar</button>
                        </div>
                    </form>
                </div>
            </section>
            <section id="section-pagamento">
                <div class="payment">
                    <div class="input-pay">
                        <input class="check" type="radio" name="pay">
                        <img src="/img/pagamento/credit-card.svg " alt="">
                    </div>
                    <div class="input-pay">
                        <input class="check" type="radio" name="pay">
                        <img src="/img/pagamento/pag-seguro.svg " alt="">
                    </div>
                    <div class="input-pay">
                        <input class="check" type="radio" name="pay">
                        <img src="/img/pagamento/pix.svg " alt="">
                    </div>
                    <div class="input-pay">
                        <input class="check" type="radio" name="pay">
                        <img src="/img/pagamento/boleto.svg " alt="">
                    </div>
                </div>

            </section>
        </div>
        <div class="pay-button">
            <button type="submit">Confirmar</button>
        </div>

        <% if(popUp) { %>
            <div class="pop-up" style="display: flex">
                <div id="pop-up-content">
                    <span><button>X</button></span>
                    <h2><%- mensagem%></h2>
                    <h4><%- aviso%></h4>
                </div>
            </div>
        <% } %>

    </main>


    <%- include('partials/footer') %>
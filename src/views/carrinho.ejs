<head>
    <script src="/javascripts/carrinho.js" defer></script>
    <link rel="stylesheet" href="/stylesheets/compra.css" />
</head>

<%- include('partials/header') %>
    <!--CONTEÚDO MAIN -->
    <main>
        <div>
            <div id="titulo">
                <h1>Finalizar Pedido</h1>
            </div>
            <section id="section-carrinho">
                <div class="content-carrinho">
                    <div id="titulo">
                        <h3>Itens: </h3>
                    </div>
                    <div id="itens-carrinho">
                        <% if(!itens[0]) { %>
                            <h3>SEU CARRINHO ESTA VAZIO</h3>
                        <% } %>
                        <% for(const filme of itens) { %>
                            <section class="item">
                                <input type="hidden" value="<%=filme.id%>" id="id" name="id">
                                <img class="imagem-produto" src="/img/<%= filme.tipo %>s/<%=filme.background%>.jpg" />
                                <div class="descricao-produto">
                                    <div>
                                        <h2 class="filme-nome">
                                            <%=filme.nome%>
                                        </h2>
                                        <br>
                                        <p class="filme-valor">
                                            R$ <%=filme.valor%>
                                        </p>
                                    </div>
                                    <div>
                                        <form action="/carrinho" method="GET" id="deletaItem">
                                            <input type="hidden" name="itensCarrinho" id="deletaItem"/>
                                            <button type="submit">
                                                <img class="remover" src="/img/ico/lixo.png" />
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </section>
                            <% } %>
                    </div>
                </div>
                <section class="pagamento">
                    <section class="resumo">
                        <div>
                            <h3>Detalhes de pagamento</h3>
                        </div>
                        <br>
                        <hr>
                        <div>
                            <h3>CARRINHO: <%= qtd %> itens</h3>
                            <span>
                                R$ <%= valor%>
                            </span>
                        </div>
                        <hr>
                        <div id="div-cupom">
                            <h3>CUPOM DE DESCONTO</h3>
                            <form action="/carrinho" method="GET" id="montarCarrinho">
                                <input type="hidden" name="itensCarrinho" id="itensCarrinho" />
                                <input name="cupom" type="text" placeholder="CUPOM" maxlength="12" value="<%= dadosCupom.cupom %>">
                                <button type="submit" id="bt-valida">Validar</button>
                                <h5 id="span-desconto"
                                    <% if(desconto == 0) { %>
                                        style="display: none;"
                                    <% } else { %>
                                        style="display: block;"
                                    <% } %>
                                >O desconto de R$ <%= desconto %> foi aplicado!</h5>
                            </form>
                        </div>
                        <hr>
                        <div>
                            <h2>TOTAL</h2>
                            <span>
                                R$ <%= total%>
                            </span>
                        </div>
                        <br>
                    </section>
                </section>
            </section>
            <% if(dados.nome_usuario) {%>
            <section id="section-dados">
                <div class="content-form">
                    <div>
                        <h1>Dados: </h1>
                    </div>
                    <div class="dados-completos">
                            <div> 
                                <h4>Nome</h4>
                                <p><%- dados.nome_usuario %></p>
                                <h4>Sobrenome</h4>
                                <p><%- dados.sobrenome%></p>
                            </div>
                            <div>
                                <h4>CPF: </h4>
                                <p><%- dados.cpf %></p>
                            </div>
                            <div>
                                <h4>Endereço:</h4>
                                <div>
                                    <h5>Logradouro:</h5>
                                    <p><%- dados.endereco %></p>
                                </div>
                                <div id="endereco">
                                    <div>
                                        <h5>Bairro: </h5>
                                        <p><%- dados.bairro %></p>
                                        <h5>Cidade: </h5>
                                        <p><%- dados.cidade %></p>
                                    </div>
                                    <div>
                                        <h5>Estado: </h5>
                                        <p><%- dados.estado %></p>
                                        <h5>CEP: </h5>
                                        <p><%- dados.codigo_postal %></p>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4>Formas de pagamento cadastrados:</h4>
                            </div>
                            <div id="bt-dados">
                                <button>Editar</button>
                            </div>
                    </div>
                </div>
            </section>
            <section id="section-pagamento">
                <div class="payment">
                    <div class="input-pay">
                        <input class="check" type="radio" name="pay">
                        <img src="/img/pagamento/credit-card.svg " alt="">
                    </div>
                    <div class="input-pay">
                        <input class="check" type="radio" name="pay">
                        <img src="/img/pagamento/pag-seguro.svg " alt="">
                    </div>
                    <div class="input-pay">
                        <input class="check" type="radio" name="pay">
                        <img src="/img/pagamento/pix.svg " alt="">
                    </div>
                    <div class="input-pay">
                        <input class="check" type="radio" name="pay">
                        <img src="/img/pagamento/boleto.svg " alt="">
                    </div>
                </div>
            </section>
        </div>
        <% } %>
        <div class="pay-button">
            <button type="submit">Confirmar</button>
        </div>

        <% if(popUp) { %>
            <div class="pop-up" style="display: flex">
                <div id="pop-up-content">
                    <span><button>X</button></span>
                    <h2><%- mensagem%></h2>
                    <h4><%- aviso%></h4>
                </div>
            </div>
        <% } %>

    </main>


    <%- include('partials/footer') %>